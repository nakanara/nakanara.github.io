

웹 사이트도 보여주기 위한 정보를 웹 서버에서 네트워크로 전달 받은 정보를 웹 브라우저로 보여주는 것입니다. 

웹 서버에서 파일을 내려주는 과정은 네트워크 연결, 파일 다운로드, 네트워크 연결 해제라는 일련의 과정이 진행되며, 내려 받을 파일의 크기가 클 수록 화면을 표시되는데까지 걸리는 시간이 길어집니다. 

웹 서버에 요청하는 리소스 파일의 수는 적을수록 좋으며, 파일의 크기는 작을 수록 좋습니다. 


서버 설정으로 텍스트 파일을 gzip으로 압축하여 전달할 수 있는 설정을 공유합니다. 
일반적으로 WEB서버에 설정을 하는 것이 가장 좋으며, 어렵다면 WAS(Tomcat7 이상) 서버에 설정도 가능합니다.


최근 브라우저의 경우 자체적으로 gzip의 압축을 풀 수 있는 기능이 포함되어 있습니다. 
! 이미지



## Apache Httpd 

* Apache httpd.conf 설정


```xml

# 기능 추가
LoadModule deflate_module modules/mod_deflate.so # gzip

<Location />
  SetOutputFilter DEFLATE

  # 오래된 브라우저는 압축 적용 안하기
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html

  # 압축 제외대상(이미지, 압축파일) 지정
  SetEnvIfNoCase Request_URI \.(?:gif|jpe?g|png|bmp|zip|t?gz|7z)$ no-gzip dont-vary
  Header append Vary User-Agent env=!dont-vary
</Location>

```

## Tomcat 

```xml
# 설정 전
<Connector connectionTimeout="20000" port="8080" protocol="HTTP/1.1" redirectPort="8443"/>

# 설정 후
<Connector connectionTimeout="20000" port="8080" protocol="HTTP/1.1" redirectPort="8443"
    compressibleMimeType="text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json,application/xm" 
    compression="on" 
    compressionMinSize="2048" 
/>
```

  - compressibleMimeType: TTP 압축이 사용될 수 있는 MIME 유형
  - compression: gzip 압축 여부
  - compressionMinSize: 압축할 최소 파일 크기(byte)



# 설정 전



# 참고
- https://caniuse.com/?search=gzip
- https://httpd.apache.org/docs/current/mod/mod_deflate.html
- https://tomcat.apache.org/tomcat-8.5-doc/config/http.html